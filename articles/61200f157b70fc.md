---
title: "ccc.nvim ã® color highlighter æ©Ÿèƒ½ã«ã¤ã„ã¦"
emoji: "ğŸˆ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Neovim"]
published: true
published_at: 2023-05-12 07:00
---

# ã¯ã˜ã‚ã«

ã“ã‚Œã¯ [Vimé§…ä¼](https://vim-jp.org/ekiden/) 5/12 ã®è¨˜äº‹ã§ã™ã€‚

æ‹™ä½œã® Neovim ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ ccc.nvim ã® highlighter æ©Ÿèƒ½ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã™ã€‚

https://github.com/uga-rosa/ccc.nvim

![LSP](https://user-images.githubusercontent.com/430272/192379267-7b069281-021a-4ee5-bc65-58def20f9c0d.png)
![NoLSP](https://user-images.githubusercontent.com/82267684/196505445-fac76002-7344-47f7-84cb-710c3ecbb717.png)

# ä½¿ã„æ–¹

ccc.nvim ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã¯ã€åŸºæœ¬çš„ã« `:CccPick` ã§æ‹¾ãˆã‚‹è‰²ã‚’å¯¾è±¡ã«ã—ã¾ã™ã€‚
ã¤ã¾ã‚Šã€ã€Œãƒã‚¤ãƒ©ã‚¤ãƒˆã•ã‚Œã¦ã„ã‚‹ã€ã¨ã€Œ`:CccPick` ã§è‰²ã‚’æ‹¾ãˆã‚‹ã€ã¯ã»ã¼ç­‰ä¾¡ã§ã™ã€‚
`:CccPick` ã¨åŒã˜æ©Ÿæ§‹ã‚’ä½¿ã£ã¦è‰²ã‚’æ¢ã—ã¦ã„ã‚‹ã®ã§ã€`pickers` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å½±éŸ¿ã‚’å—ã‘ã¾ã™ã€‚[è¨­å®š](#picker)ã®é …ã§è©³ã—ãè¿°ã¹ã¾ã™ã€‚

ccc.nvim ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã¯ã€ãƒãƒƒãƒ•ã‚¡å˜ä½ã§ç®¡ç†ã•ã‚Œã¾ã™ã€‚
æœ‰åŠ¹åŒ–ã«ã¯

- æ‰‹å‹•æœ‰åŠ¹åŒ–
- è‡ªå‹•æœ‰åŠ¹åŒ–

ã® 2 ã¤ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚

æ‰‹å‹•æœ‰åŠ¹åŒ–ã¯ `:CccHighlighterEnable` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã„ã¾ã™ã€‚
å¼•æ•°ã¨ã—ã¦ãƒãƒƒãƒ•ã‚¡ ID ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€çœç•¥ã™ã‚Œã°ç¾åœ¨ã®ãƒãƒƒãƒ•ã‚¡ãŒå¯¾è±¡ã«ãªã‚Šã¾ã™ã€‚
`:CccHighlighterDisable` / `:CccHighlighterToggle` ã‚‚ã‚ã‚Šã¾ã™ã€‚

è‡ªå‹•æœ‰åŠ¹åŒ–ã¯ `setup()` ã§è¨­å®šã—ã¾ã™ã€‚
[è¨­å®š](#è¨­å®š)ã®é …ã§è©³ã—ãè¿°ã¹ã¾ã™ã€‚

# è¨­å®š

`setup()` é–¢æ•°ã‚’é€šã—ã¦è¨­å®šã—ã¾ã™ã€‚
ã“ã‚Œã¯ ccc.nvim ã®è¨­å®šå…¨èˆ¬ã§å…±é€šã§ã™ã€‚

```lua
local ccc = require("ccc")
ccc.setup({
  highlighter = {
    -- Default values
    auto_enable = false,
    max_byte = 100 * 1024,
    filetypes = {},
    excludes = {},
    lsp = true,
  },
})
```

- auto_enable (false)
  - `true` ã«ã™ã‚‹ã¨ highlighter ãŒè‡ªå‹•ã§æœ‰åŠ¹åŒ–ã•ã‚Œã¾ã™
  - æœ‰åŠ¹åŒ–ã®æ¡ä»¶ã¯ã“ã®å¾Œã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æŒ‡å®šã•ã‚Œã¾ã™
- max_byte (100 KB)
  - å˜ä½ã¯ byte
  - highlighter ãŒæœ‰åŠ¹åŒ–ã•ã‚Œã‚‹ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºã®ä¸Šé™ã§ã™
- filetypes ({})
  - æœ‰åŠ¹åŒ–ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ã®ãƒªã‚¹ãƒˆã§ã™
  - ç©ºã®å ´åˆã¯ã€å…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ã§æœ‰åŠ¹ã«ãªã‚Šã¾ã™
- excludes ({})
  - ç„¡åŠ¹åŒ–ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ã®ãƒªã‚¹ãƒˆã§ã™
  - filetypes ãŒç©ºã®å ´åˆã®ã¿æœ‰åŠ¹ã§ã™
- lsp (true)
  - LSP ã® `textDocument/documentColor` ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½¿ã£ã¦ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ã¾ã™

![LSP](https://user-images.githubusercontent.com/430272/192379267-7b069281-021a-4ee5-bc65-58def20f9c0d.png)

## picker

- `:CccPick` ã‚„ãƒã‚¤ãƒ©ã‚¤ãƒˆã§è‰²ã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã€`ccc.picker.*` ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™
- `setup()` ã§æ¸¡ã™ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã® `pickers` ã«æŒ‡å®šã—ãŸã‚‚ã®ãŒä½¿ã‚ã‚Œã¾ã™
- åŸºæœ¬çš„ãª picker ã¯ CSS Color Module Level 4 ã«æº–æ‹ ã—ã¦ã„ã¾ã™

```lua
local ccc = require("ccc")
ccc.setup({
  highlighter = {
    auto_enable = false,
  },
  pickers = {
    ccc.picker.hex,
    ccc.picker.css_rgb,
    ccc.picker.css_hsl,
    ccc.picker.css_hwb,
    ccc.picker.css_lab,
    ccc.picker.css_lch,
    ccc.picker.css_oklab,
    ccc.picker.css_oklch,
  },
})
```

![NoLSP](https://user-images.githubusercontent.com/82267684/196505445-fac76002-7344-47f7-84cb-710c3ecbb717.png)

## ç‰¹åˆ¥ãªpicker

- ã„ãã¤ã‹ç‰¹æ®Šãª picker ã‚‚ã‚ã‚Šã¾ã™ã€‚
  - custom_entries
  - trailing_whitespace
  - ansi_escape

- custom_entries
  - æ–‡å­—åˆ—ã¨è‰²ã®å¯¾å¿œãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ä»»æ„ã®æ–‡å­—åˆ—ã‚’ä»»æ„ã®è‰²ã§ãƒã‚¤ãƒ©ã‚¤ãƒˆã§ãã¾ã™
  - ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ ã‚„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ã‚¤ãƒ³ã®è¨­å®šã‚’ä½œã‚‹ã¨ããªã©ã«å½¹ç«‹ã¡ã¾ã™
  - @delphinus ã•ã‚“ãŒä½œæˆã—ã¦ãã ã•ã‚Šã¾ã—ãŸ

```lua
ccc.setup({
  pickers = {
    ccc.picker.custom_entries({
      red = "#ff0000",
      green = "#00ff00",
      -- etc.
    }),
  },
})
```

![custom_entries](https://user-images.githubusercontent.com/1239245/221404713-d7acabbd-8587-4869-8c5c-06a933e6faab.png)

- trailing_whitespace
  - ãƒã‚¤ãƒ©ã‚¤ãƒˆå°‚ç”¨ã§ã™ï¼ˆã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã‚ˆã£ã¦ãƒã‚¤ãƒ©ã‚¤ãƒˆã•ã‚Œã¦ã„ã¦ã‚‚ `:CccPick` ã§è‰²ã‚’æ‹¾ã†ã“ã¨ã¯ã§ãã¾ã›ã‚“ï¼‰
  - æœ«å°¾ã®ç©ºç™½ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ã¾ã™
  - ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ç‹¬ç«‹ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ã®æŒ‡å®šãŒè¡Œãˆã¾ã™
  - ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ã”ã¨ã«è‰²ã‚’æŒ‡å®šã§ãã¾ã™

```lua
ccc.setup({
  pickers = {
    ccc.picker.trailing_whitespace({
      ---@type table<string, string>
      --- Keys are filetypes, values are colors (6-digit hex)
      palette = {},
      ---@type string
      --- Default color. 6-digit hex representation.
      default_color = "#db7093",
      ---@type string[]|true
      --- List of filetypes for which highlighting is enabled or true.
      enable = true,
      ---@type string[]
      --- Used only when enable is true. List of filetypes for which
      --- highlighting is disabled.
      disable = {},
    }),
  },
})
```

![trailing_whitespace](https://storage.googleapis.com/zenn-user-upload/65115f602ce9-20230512.png)

- ansi_escape
  - ãƒã‚¤ãƒ©ã‚¤ãƒˆå°‚ç”¨ã§ã™
  - ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®å‡ºåŠ›ã«è‰²ã‚’ä»˜ã‘ã‚‹ã€ANSIã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ã¾ã™

```lua
ccc.setup({
  pickers = {
    ccc.picker.ansi_escape({
      foreground = "#cccccc",
      background = "#0c0c0c",
      black = "#0c0c0c",
      red = "#c50f1f",
      green = "#13a10e",
      yellow = "#c19c00",
      blue = "#0037da",
      magenta = "#881798",
      cyan = "#3a96dd",
      white = "#cccccc",
      bright_black = "#767676",
      bright_red = "#e74856",
      bright_green = "#16c60c",
      bright_yellow = "#f9f1a5",
      bright_blue = "#3b78ff",
      bright_magenta = "#b4009e",
      bright_cyan = "#61d6d6",
      bright_white = "#f2f2f2",
    }, {
      -- `\e[31;1m` means whether `red + bold` or `bright red`.
      ---@type "bold"|"bright" Meaning of code 1. default: "bright"
      meaning1 = "bright",
    })
  }
})
```

![ansi_escape](https://storage.googleapis.com/zenn-user-upload/a7d23455c274-20230512.png)

# ãŠã‚ã‚Š

`picker/trailing_whitespace` ã¯ã¤ã„å…ˆç¨‹å…¥ã‚ŒãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã€‚
æ‹¡å¼µæ€§ãŒé«˜ãã€ãƒ—ãƒªã‚»ãƒƒãƒˆã‚‚å……å®Ÿã—ãŸãƒã‚¤ãƒ©ã‚¤ãƒˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ã—ã¦æ˜¯éãŠè©¦ã—ãã ã•ã„ã€‚
